"use client";
import * as React from "react";
import { useState } from "react";

function TaskManager() {
  const [categories, setCategories] = useState(() => [
    "Work",
    "Personal",
    "Health",
    "Learning",
  ]);

  const [priorities, setPriorities] = useState(() => [
    "Low",
    "Medium",
    "High",
    "Urgent",
  ]);

  const [selectedCategory, setSelectedCategory] = useState(() => "All");

  const [showTaskDetails, setShowTaskDetails] = useState(() => false);

  const [selectedTask, setSelectedTask] = useState(() => null);

  const [tasks, setTasks] = useState(() => [
    {
      id: 1,
      title: "ğŸŒ… Morning Meditation",
      completed: false,
      category: "Health",
      priority: "High",
      dueDate: "2024-01-20",
      notes: "Focus on breathing exercises",
      timeEstimate: 15,
      timeSpent: 0,
      subtasks: [
        {
          id: 1.1,
          title: "Set up meditation space",
          completed: false,
        },
        {
          id: 1.2,
          title: "10 min mindfulness",
          completed: false,
        },
      ],
      shared: ["team@example.com"],
    },
    {
      id: 2,
      title: "ğŸ’ª Workout Session",
      completed: false,
      category: "Health",
      priority: "Medium",
      dueDate: "2024-01-20",
      notes: "Full body workout",
      timeEstimate: 45,
      timeSpent: 0,
      subtasks: [
        {
          id: 2.1,
          title: "Warm up",
          completed: false,
        },
        {
          id: 2.2,
          title: "Main exercise",
          completed: false,
        },
        {
          id: 2.3,
          title: "Cool down",
          completed: false,
        },
      ],
      shared: [],
    },
    {
      id: 3,
      title: "ğŸ“Š Daily Planning",
      completed: false,
      category: "Work",
      priority: "High",
      dueDate: "2024-01-20",
      notes: "Review goals and set priorities",
      timeEstimate: 20,
      timeSpent: 0,
      subtasks: [
        {
          id: 3.1,
          title: "Review yesterday's progress",
          completed: false,
        },
        {
          id: 3.2,
          title: "Set today's priorities",
          completed: false,
        },
      ],
      shared: ["team@example.com"],
    },
  ]);

  function toggleTask(id) {
    setTasks(
      tasks.map((task) =>
        task.id === id
          ? {
              ...task,
              completed: !task.completed,
            }
          : task,
      ),
    );
  }

  return (
    <div className="bg-white ease-in-out duration-[0.3s] transition-[color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter]">
      <TaskHeader />
      <TaskList tasks={tasks} toggleTask={toggleTask} />
      <BottomNavigation />
    </div>
  );
}

function TaskHeader() {
  return (
    <header className="p-6 text-3xl font-bold leading-9 text-center text-gray-800 border-b">
      âœ¨ My Daily Tasks
    </header>
  );
}

function TaskList({ tasks, toggleTask }) {
  return (
    <main className="p-4">
      {tasks?.map((task, index) => (
        <TaskItem
          key={task.id}
          task={task}
          index={index}
          toggleTask={toggleTask}
        />
      ))}
    </main>
  );
}

function TaskItem({ task, index, toggleTask }) {
  const gradientBackground =
    index === 0
      ? "linear-gradient(to right, rgb(74, 222, 128), rgb(59, 130, 246), rgb(147, 51, 234))"
      : index === 1
        ? "linear-gradient(to right, rgb(236, 72, 153), rgb(234, 179, 8), rgb(239, 68, 68))"
        : "linear-gradient(to right, rgb(99, 102, 241), rgb(147, 51, 234), rgb(236, 72, 153))";

  const completedSubtasks = task.subtasks.filter((st) => st.completed).length;

  return (
    <article
      className="p-5 mb-5 rounded-2xl shadow-lg transition-all translate-y-0 cursor-pointer duration-[0.3s] ease-[ease]"
      onClick={() => toggleTask(task.id)}
      style={{ backgroundImage: gradientBackground }}
    >
      <div className="flex justify-between items-center text-white">
        <div className="flex flex-col flex-1 gap-2">
          <div className="flex justify-between items-center w-full">
            <span
              className="text-lg font-medium"
              style={{
                textDecoration: task.completed ? "line-through" : "none",
                opacity: task.completed ? 0.7 : 1,
              }}
            >
              {task.title}
            </span>
            <div className="flex gap-3 items-center">
              <span className="px-2 py-1 text-sm rounded-xl bg-white bg-opacity-20">
                {task.category}
              </span>
              <span className="text-sm">
                <span>â° </span>
                <span>{task.timeEstimate}</span>
                <span>m</span>
              </span>
            </div>
          </div>
          <div className="flex gap-4 items-center text-sm">
            <span>
              <span>ğŸ“… </span>
              <span>{task.dueDate}</span>
            </span>
            <span>
              <span>ğŸ¯ </span>
              <span>{task.priority}</span>
            </span>
            {task.subtasks.length > 0 ? (
              <span>
                <span>ğŸ“‹ </span>
                <span>{completedSubtasks}</span>
                <span>/</span>
                <span>{task.subtasks.length}</span>
              </span>
            ) : null}
          </div>
        </div>
        <input
          type="checkbox"
          className="w-6 h-6 cursor-pointer"
          checked={task.completed}
          onChange={() => toggleTask(task.id)}
          aria-label={`Mark ${task.title} as ${task.completed ? "incomplete" : "complete"}`}
        />
      </div>
    </article>
  );
}

function BottomNavigation() {
  return (
    <nav className="flex fixed inset-x-0 bottom-0 justify-around py-2 bg-white border-t border-[1px_0px_0px]">
      <NavItem icon="ğŸ“‹" label="Tasks" />
      <NavItem icon="ğŸ“…" label="Calendar" />
      <NavItem icon="ğŸ”" label="Habits" />
      <NavItem icon="ğŸ“" label="Notes" />
      <NavItem icon="âš™ï¸" label="Settings" />
    </nav>
  );
}

function NavItem({ icon, label }) {
  return (
    <button className="text-sm leading-5 text-center text-gray-500">
      <div>{icon}</div>
      <div>{label}</div>
    </button>
  );
}

export default TaskManager;
